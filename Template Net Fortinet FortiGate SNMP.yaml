zabbix_export:
  version: '5.4'
  date: '2021-11-09T14:48:07Z'
  groups:
    -
      name: 'Templates/Network devices'
  templates:
    -
      template: 'Template Net Fortinet FortiGate SNMP'
      name: 'Template Net Fortinet FortiGate SNMP'
      description: |
        Zabbix Template for Fortinet FortiGate
        URL: https://github.com/mbdraks/fortinet-zabbix
        Author: Michel Barbosa
        Version: 2.1.1
        
        Exposes information obtained from the following MIBs (import is not required):
        - SNMPv2-MIB
        - IF-MIB
        - EtherLike-MIB
        - FORTINET-CORE-MIB
        - FORTINET-FORTIGATE-MIB
        
        This template also incorporates the exact same data collected by the following default templates (no import or link required):
        - Generic SNMP
        - Interfaces SNMP
        - EtherLike-MIB SNMP
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          name: 'Logical Description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.47.1.2.1.1.2.1
          key: entLogicalDescr
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            ENTITY-MIB::entLogicalDescr
            
            A textual description of the logical entity.  This object
            should contain a string which identifies the manufacturer's
            name for the logical entity, and should be set to a distinct
            value for each version of the logical entity.
          inventory_link: SOFTWARE_FULL
          tags:
            -
              tag: Application
              value: Inventory
        -
          name: 'Physical Description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.47.1.1.1.1.2.1
          key: entPhysicalDesc
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            ENTITY-MIB::entPhysicalDescr
            
            A textual description of physical entity.  This object
            should contain a string which identifies the manufacturer's
            name for the physical entity, and should be set to a
            distinct value for each version or model of the physical
            entity.
          inventory_link: HARDWARE_FULL
          tags:
            -
              tag: Application
              value: Inventory
        -
          name: 'HA Config Sync'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.5.0
          key: fgHaAutoSync
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaAutoSync
            
            Configuration of an automatic configuration
            synchronization (enabled or disabled)
          valuemap:
            name: 'FORTINET-CORE-MIB::FnBoolState'
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'HA Cluster Group ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.2.0
          key: fgHaGroupId
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaSystemMode
            
            HA cluster group ID device is configured for
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'HA Cluster Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.7.0
          key: fgHaGroupName
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgHaGroupName
            
            HA cluster group name
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'HA Cluster Master Override'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.4.0
          key: fgHaOverride
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaOverride
            
            Status of a master override flag
          valuemap:
            name: 'FORTINET-CORE-MIB::FnBoolState'
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'HA Cluster Priority'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.3.0
          key: fgHaPriority
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaPriority
            
            HA clustering priority of the device (default = 128)
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'HA Load-balancing Schedule'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.6.0
          key: fgHaSchedule
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaSchedule
            
            Load-balancing schedule of cluster (in A-A mode)
          valuemap:
            name: 'FORTINET-FORTIGATE-MIB::FgHaLBSchedule'
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'HA Mode'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.13.1.1.0
          key: fgHaSystemMode
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaSystemMode
            
            High-availability mode (Standalone, A-A or A-P)
          valuemap:
            name: 'FORTINET-FORTIGATE-MIB::FgHaMode'
          tags:
            -
              tag: Application
              value: 'High Availability'
        -
          name: 'Hardware Sensor Count'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.3.1.0
          key: fgHwSensorCount
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHwSensorCount
            
            The number of entries in fgHwSensorTable
          tags:
            -
              tag: Application
              value: 'Hardware Sensor'
        -
          name: 'Intrusions detected - Anomaly based'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.9.1
          key: fgIpsAnomalyDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsAnomalyDetections
            
            Number of intrusions detected by signature
            since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected - Critical'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.3.1
          key: fgIpsCritSevDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsCritSevDetections
            
            Number of critical severity intrusions
            detected since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected - High'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.4.1
          key: fgIpsHighSevDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsHighSevDetections
            
            Number of high severity intrusions 
            detected since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected - Info'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.7.1
          key: fgIpsInfoSevDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsInfoSevDetections
            
            Number of informational severity intrusions
            detected since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions blocked'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.2.1
          key: fgIpsIntrusionsBlocked
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsIntrusionsBlocked
            
            Number of intrusions blocked since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.1.1
          key: fgIpsIntrusionsDetected
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsIntrusionsDetected
            
            Number of intrusions detected since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected - Low'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.6.1
          key: fgIpsLowSevDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsLowSevDetections
            
            Number of low severity intrusions 
            detected since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected - Medium'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.5.1
          key: fgIpsMedSevDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsMedSevDetections
            
            Number of medium severity intrusions 
            detected since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'Intrusions detected - Signature based'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.9.2.1.1.8.1
          key: fgIpsSignatureDetections
          description: |
            FORTINET-FORTIGATE-MIB::fgIpsSignatureDetections
            
            Number of intrusions detected by signature
            since start-up in this virtual domain
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'CPU usage'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.3.0
          key: fgSysCpuUsage
          units: '%'
          description: |
            FORTINET-FORTIGATE-MIB::fgSysCpuUsage
            
            Current CPU usage (percentage)
          tags:
            -
              tag: Application
              value: CPU
          triggers:
            -
              expression: 'min(/Template Net Fortinet FortiGate SNMP/fgSysCpuUsage,5m)>{$CPU.UTIL.CRIT}'
              name: 'High CPU usage (over {$CPU.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'CPU utilization is too high. The system might be slow to respond.'
        -
          name: 'Hard Disk Capacity'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.7.0
          key: fgSysDiskCapacity
          delay: 1h
          units: B
          description: |
            FORTINET-FORTIGATE-MIB::fgSysDiskCapacity
            
            Total hard disk capacity (MB), if disk is present
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Storage
        -
          name: 'Hard Disk Usage'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.6.0
          key: fgSysDiskUsage
          units: B
          description: |
            FORTINET-FORTIGATE-MIB::fgSysDiskUsage
            
            Current hard disk usage (MB), if disk is present
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Storage
        -
          name: 'Hard Disk Usage Rate'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.6.0
          key: fgSysDiskUsage.Rate
          units: B
          description: |
            FORTINET-FORTIGATE-MIB::fgSysDiskUsage
            
            Current hard disk usage (MB), if disk is present
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
            -
              type: MULTIPLIER
              parameters:
                - '1024'
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            -
              tag: Application
              value: Storage
        -
          name: 'Memory usage'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.4.0
          key: fgSysMemUsage
          description: |
            FORTINET-FORTIGATE-MIB::fgSysMemUsage
            
            Current memory utilization (percentage)
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              expression: 'min(/Template Net Fortinet FortiGate SNMP/fgSysMemUsage,5m)>{$MEMORY.UTIL.MAX}'
              name: 'High memory usage ( >{$MEMORY.UTIL.MAX}% for 5m)'
              priority: WARNING
              description: 'The system is running out of free memory.'
        -
          name: 'IPv4 Active sessions'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.8.0
          key: fgSysSesCount
          description: |
            FORTINET-FORTIGATE-MIB::fgSysSesCount
            
            Number of active sessions on the device
          tags:
            -
              tag: Application
              value: Session
        -
          name: 'FortiGate Uptime'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.20.0
          key: fgSysUpTime
          history: 2w
          trends: '0'
          units: uptime
          description: |
            FORTINET-FORTIGATE-MIB::fgSysUpTime
            
            The 64bit time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: Application
              value: Status
        -
          name: 'Firmware Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.1.0
          key: fgSysVersion
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgSysVersion
            
            Firmware version of the device
          inventory_link: OS_SHORT
          tags:
            -
              tag: Application
              value: Inventory
        -
          name: 'IPS Database Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.2.2.0
          key: fgSysVersionIps
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgSysVersionIps
            
            IPS signature database version installed on the device
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'IPS Database Version - Extended'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.2.4.0
          key: fgSysVersionIpsEt
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgSysVersionIpsEt
            
            IPS signature extended database version installed on the device
          tags:
            -
              tag: Application
              value: IPS
        -
          name: 'VDOM Enabled'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.3.1.3.0
          key: fgVdEnabled
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgVdEnabled
            
            Whether virtual domains are enabled on this device
          valuemap:
            name: 'FORTINET-CORE-MIB::FnBoolState'
          tags:
            -
              tag: Application
              value: 'Virtual Domain'
        -
          name: 'VDOM Max Count'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.3.1.2.0
          key: fgVdMaxVdoms
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgVdMaxVdoms
            
            The maximum number of virtual domains allowed on the device as allowed by hardware and/or licensing
          tags:
            -
              tag: Application
              value: 'Virtual Domain'
        -
          name: 'VDOM Count'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.3.1.1.0
          key: fgVdNumber
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgVdNumber
            
            The number of virtual domains in vdTable
          tags:
            -
              tag: Application
              value: 'Virtual Domain'
        -
          name: 'SSL VPN state'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.12.2.3.1.1.1
          key: fgVpnSslState
          description: |
            FORTINET-FORTIGATE-MIB::fgVpnSslState
            
            Whether SSL-VPN is enabled on this virtual domain
          valuemap:
            name: 'FORTINET-CORE-MIB::FnBoolState'
          tags:
            -
              tag: Application
              value: VPN
        -
          name: 'Active SSL VPN users'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.12.2.3.1.2.1
          key: fgVpnSslStatsLoginUsers
          description: |
            FORTINET-FORTIGATE-MIB::fgVpnSslStatsLoginUsers
            
            The current number of users logged in through SSL-VPN tunnels in the virtual domain
          tags:
            -
              tag: Application
              value: VPN
        -
          name: 'Active IPsec VPN tunnels'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.12.1.1.0
          key: fgVpnTunnelUpCount
          description: |
            FORTINET-FORTIGATE-MIB::fgVpnTunnelUpCount
            
            The number of IPsec VPN tunnels with at least one SA
          tags:
            -
              tag: Application
              value: VPN
        -
          name: 'Wireless Controller - Location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.2.0
          key: fgWcInfoLocation
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoLocation
            
            Represents the location of an AC
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Wireless Controller - Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.1.0
          key: fgWcInfoName
          history: 7d
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoName
            
            Represents the name of an AC
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Wireless Controller - Station Capacity'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.6.0
          key: fgWcInfoStationCapacity
          delay: 1h
          history: 7d
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoStationCapacity
            
            Represents the maximum number of stations that can be supported on the AC.
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Wireless Controller - Station Count'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.7.0
          key: fgWcInfoStationCount
          history: 7d
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoStationCount
            
            Represents the number of stations that are accessing the wireless service
            provided by the AC.
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Wireless Controller - WTP Capacity'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.3.0
          key: fgWcInfoWtpCapacity
          delay: 1h
          history: 7d
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoWtpCapacity
            
            Represents the maximum number of WTPs that can be managed on the AC.
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Wireless Controller - WTP Managed'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.4.0
          key: fgWcInfoWtpManaged
          history: 7d
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoWtpManaged
            
            Represents the number of WTPs being managed on the AC.
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Wireless Controller - WTP Sessions'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.14.2.5.0
          key: fgWcInfoWtpSessions
          history: 7d
          description: |
            FORTINET-FORTIGATE-MIB::fgWcInfoWtpSessions
            
            Represents the number of WTPs that are connecting to the AC.
          tags:
            -
              tag: Application
              value: Wireless
        -
          name: 'Device Serial Number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.100.1.1.1.0
          key: fnSysSerial
          delay: 1h
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-CORE-MIB::fnSysSerial
            
            Device serial number. This is the same serial number as given
            in the ENTITY-MIB tables for the base entity.
            
            If in HA returns the master SN only.
          inventory_link: SERIALNO_A
          tags:
            -
              tag: Application
              value: Inventory
        -
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          history: 1w
          valuemap:
            name: 'Service state'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              expression: 'max(/Template Net Fortinet FortiGate SNMP/icmpping,#3)=0'
              name: 'Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout.  Please check device connectivity.'
        -
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              expression: 'min(/Template Net Fortinet FortiGate SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Template Net Fortinet FortiGate SNMP/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Net Fortinet FortiGate SNMP/icmpping,#3)=0'
        -
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              expression: 'avg(/Template Net Fortinet FortiGate SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              dependencies:
                -
                  name: 'High ICMP ping loss'
                  expression: 'min(/Template Net Fortinet FortiGate SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Template Net Fortinet FortiGate SNMP/icmppingloss,5m)<100'
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Net Fortinet FortiGate SNMP/icmpping,#3)=0'
        -
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          history: 2w
          trends: '0'
          value_type: LOG
          description: 'Item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            -
              tag: Application
              value: General
        -
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: General
        -
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: General
        -
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: Application
              value: General
        -
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: Application
              value: General
          triggers:
            -
              expression: '(last(/Template Net Fortinet FortiGate SNMP/system.name,#1)<>last(/Template Net Fortinet FortiGate SNMP/system.name,#2))=1 and length(last(/Template Net Fortinet FortiGate SNMP/system.name))>0'
              name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
        -
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: Application
              value: General
        -
          name: 'Operating System'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.12356.101.4.1.1.0
          key: 'system.sw.os[sysDescr.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            FORTINET-FORTIGATE-MIB::fgSysVersion
            
            Firmware version of the device
          inventory_link: OS
          tags:
            -
              tag: Application
              value: Inventory
        -
          name: Uptime
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.uptime[sysUpTime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              expression: 'last(/Template Net Fortinet FortiGate SNMP/system.uptime[sysUpTime.0])<10m'
              name: '{HOST.NAME} has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'Uptime is less than 10 minutes'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'No SNMP data collection'
                  expression: 'max(/Template Net Fortinet FortiGate SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
        -
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          valuemap:
            name: zabbix.host.available
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              expression: 'max(/Template Net Fortinet FortiGate SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Net Fortinet FortiGate SNMP/icmpping,#3)=0'
      discovery_rules:
        -
          name: 'High Availability Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#HA_ID},1.3.6.1.4.1.12356.101.13.2.1.1.1,{#HA_SN},1.3.6.1.4.1.12356.101.13.2.1.1.2]'
          key: fgHaStatsTable.discovery
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgHaStatsTable
            
            Some useful statistics for all members of a cluster. This table is also available in standalone mode.
          item_prototypes:
            -
              name: 'HA Cluster Member {#HA_ID} - AV Events Rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.10.{#HA_ID}'
              key: 'fgHaStatsAvCount.rate.[{#HA_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsAvCount
                
                Number of anti-virus events triggered on the specified cluster member since start-up
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Bytes Processed Rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.8.{#HA_ID}'
              key: 'fgHaStatsByteCount.rate.[{#HA_ID}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsByteCount
                
                Number of bytes processed by the specified cluster member since start-up
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - CPU Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.3.{#HA_ID}'
              key: 'fgHaStatsCpuUsage.[{#HA_ID}]'
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsCpuUsage
                
                CPU usage of the specified cluster member (percentage)
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Global Checksum'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.15.{#HA_ID}'
              key: 'fgHaStatsGlobalChecksum.[{#HA_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsGlobalChecksum
                
                Current HA global checksum value
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Hostname'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.11.{#HA_ID}'
              key: 'fgHaStatsHostname.[{#HA_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsHostname
                
                Host name of the specified cluster member
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - IPS Events Rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.9.{#HA_ID}'
              key: 'fgHaStatsIdsCount.rate.[{#HA_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsIdsCount
                
                Number of IDS/IPS events triggered on the specified cluster member since start-up
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Master SN'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.16.{#HA_ID}'
              key: 'fgHaStatsMasterSerial.[{#HA_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsMasterSerial
                
                Serial number of master during the last synch attempt (successful of not)
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Memory Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.4.{#HA_ID}'
              key: 'fgHaStatsMemUsage.[{#HA_ID}]'
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsMemUsage
                
                Memory usage of the specified cluster member (percentage)
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Network Bandwidth Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.5.{#HA_ID}'
              key: 'fgHaStatsNetUsage.[{#HA_ID}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsNetUsage
                
                Network bandwidth usage of specified cluster member (kbps)
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1024'
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Packets Processed Rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.7.{#HA_ID}'
              key: 'fgHaStatsPktCount.rate.[{#HA_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsPktCount
                
                Number of packets processed by the specified cluster member since start-up
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Serial Number'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.2.{#HA_ID}'
              key: 'fgHaStatsSerial.[{#HA_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsSerial
                
                Serial number of the HA cluster member
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Concurrent Connections'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.6.{#HA_ID}'
              key: 'fgHaStatsSesCount.[{#HA_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsSesCount
                
                Current session count of specified cluster member
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Sync Success Time'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.13.{#HA_ID}'
              key: 'fgHaStatsSyncDatimeSucc.[{#HA_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsSyncDatimeSucc
                
                Date and time of last successful sync
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Sync Failed Time'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.14.{#HA_ID}'
              key: 'fgHaStatsSyncDatimeUnsucc.[{#HA_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsSyncDatimeUnsucc
                
                Date and time of last unsuccessful sync
              tags:
                -
                  tag: Application
                  value: 'High Availability'
            -
              name: 'HA Cluster Member {#HA_ID} - Sync Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.13.2.1.1.12.{#HA_ID}'
              key: 'fgHaStatsSyncStatus.[{#HA_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgHaStatsSyncStatus
                
                Current HA Sync status
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::FgHaStatsSyncStatusType'
              tags:
                -
                  tag: Application
                  value: 'High Availability'
          graph_prototypes:
            -
              name: 'HA Cluster Member {#HA_ID} - Concurrent Connections'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgHaStatsSesCount.[{#HA_ID}]'
            -
              name: 'HA Cluster Member {#HA_ID} - CPU Usage'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgHaStatsCpuUsage.[{#HA_ID}]'
            -
              name: 'HA Cluster Member {#HA_ID} - Memory Usage'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgHaStatsMemUsage.[{#HA_ID}]'
            -
              name: 'HA Cluster Member {#HA_ID} - Network Bandwidth Usage'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgHaStatsNetUsage.[{#HA_ID}]'
            -
              name: 'HA Cluster Member {#HA_ID} - Security Events Rate'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgHaStatsAvCount.rate.[{#HA_ID}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgHaStatsIdsCount.rate.[{#HA_ID}]'
        -
          name: 'Hardware Sensor Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_ID},1.3.6.1.4.1.12356.101.4.3.2.1.1,{#SENSOR_NAME},1.3.6.1.4.1.12356.101.4.3.2.1.2]'
          key: fgHwSensorEntIndex.discovery
          delay: 1h
          lifetime: '0'
          description: |
            FORTINET-FORTIGATE-MIB::fgHwSensorEntIndex
            
            A list of device specific hardware sensors and values. Because different devices have different hardware sensor capabilities, this table may or may not contain any values.
          item_prototypes:
            -
              name: 'Hardware Sensor {#SENSOR_NAME} - Alarm Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.3.2.1.4.{#SENSOR_ID}'
              key: 'fgHwSensorEntAlarmStatus.[{#SENSOR_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgHwSensorEntAlarmStatus
                
                If the sensor has an alarm threshold and has exceeded it, this will indicate its status. Not all sensors have alarms.
              valuemap:
                name: 'Alarm state'
              tags:
                -
                  tag: Application
                  value: 'Hardware Sensor'
            -
              name: 'Hardware Sensor {#SENSOR_NAME} - Value'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.3.2.1.3.{#SENSOR_ID}'
              key: 'fgHwSensorEntValue.[{#SENSOR_ID}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgHwSensorEntValue
                
                A string representation of the value of the sensor. Because sensors can present data in different formats, string representation is most general format. Interpretation of the value (units of measure, for example) is dependent on the individual sensor.
              tags:
                -
                  tag: Application
                  value: 'Hardware Sensor'
        -
          name: 'Interface-based Shaping (Egress) Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CLASS_ID},1.3.6.1.4.1.12356.101.7.5.2.1.1.{$IF_ID1}]'
          key: fgIntfBcEntry.discovery
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgIntfBcEntry
            
            A list of all class-levels with bandwidth usage and packet drop counter.
            An entry containing the Bandwidth Control statistics, packet drop counter of a given interface.
            
            The data collected by this discovery is the same found using:
            `diagnose netlink interface list wan1`
          item_prototypes:
            -
              name: 'Allocated Bandwidth - Interface ID {$IF_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.2.1.1.{$IF_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcAllocatedBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcAllocatedBandwidth
                
                Allocated Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Byte Rate - Interface ID {$IF_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.2.1.5.{$IF_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcBytes.rate.[{$IF_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcBytes
                
                Bytes of a given inteface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Current Bandwidth - Interface ID {$IF_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.2.1.4.{$IF_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcCurrentBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcCurrentBandwidth
                
                Current Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Packet Drop - Interface ID {$IF_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.2.1.6.{$IF_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcDrops.[{$IF_ID1}.{#SNMPINDEX}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcDrops
                
                Packet drop counter of a given interface and class-level.
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Guaranteed Bandwidth - Interface ID {$IF_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.2.1.2.{$IF_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcGuaranteedBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcGuaranteedBandwidth
                
                Guaranteed Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Maximum Bandwidth - Interface ID {$IF_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.2.1.3.{$IF_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcMaxBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcMaxBandwidth
                
                Max Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
          graph_prototypes:
            -
              name: 'Interface-based Shaping (Egress) Metrics - Class ID {#SNMPINDEX}'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcAllocatedBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcBytes.rate.[{$IF_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcCurrentBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '3'
                  color: F7941D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcGuaranteedBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '4'
                  color: FC6EA3
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcMaxBandwidth.[{$IF_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '5'
                  color: 6C59DC
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcDrops.[{$IF_ID1}.{#SNMPINDEX}]'
        -
          name: 'Interface-based Shaping (Ingress) Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CLASS_ID},1.3.6.1.4.1.12356.101.7.5.3.1.1.{$IF_IN_ID1}]'
          key: fgIntfBcInEntry.discovery
          delay: 1h
          description: |
            FORTINET-FORTIGATE-MIB::fgIntfBcInEntry
            
            A list of all class-levels with bandwidth usage and packet drop counter.
            An entry containing the Bandwidth Control statistics, packet drop counter of a given interface.
            
            For ingress bc use estimated-downstream-bandwidth and ingress-shaping-profile
          item_prototypes:
            -
              name: 'Ingress Allocated Bandwidth - Interface ID {$IF_IN_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.3.1.1.{$IF_IN_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcInAllocatedBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcInAllocatedBandwidth
                
                Allocated Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Ingress Byte Rate - Interface ID {$IF_IN_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.3.1.5.{$IF_IN_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcInBytes.rate.[{$IF_IN_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcInBytes
                
                Bytes of a given inteface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Ingress Current Bandwidth - Interface ID {$IF_IN_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.3.1.4.{$IF_IN_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcInCurrentBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcInCurrentBandwidth
                
                Current Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Ingress Packet drop - Interface ID {$IF_IN_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.3.1.6.{$IF_IN_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcInDrops.[{$IF_IN_ID1}.{#SNMPINDEX}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcInDrops
                
                Packet drop counter of a given interface and class-level.
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Ingress Guaranteed Bandwidth - Interface ID {$IF_IN_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.3.1.2.{$IF_IN_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcInGuaranteedBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcInGuaranteedBandwidth
                
                Guaranteed Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
            -
              name: 'Ingress Maximum Bandwidth - Interface ID {$IF_IN_ID1} - Class ID {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.5.3.1.3.{$IF_IN_ID1}.{#SNMPINDEX}'
              key: 'fgIntfBcInMaxBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfBcInMaxBandwidth
                
                Max Bandwidth of a given interface and class-level.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000'
              tags:
                -
                  tag: Application
                  value: 'Interface-based Shaping'
          graph_prototypes:
            -
              name: 'Interface-based Shaping (Ingress) Metrics - {#SNMPINDEX}'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcInAllocatedBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcInBytes.rate.[{$IF_IN_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcInCurrentBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '3'
                  color: F7941D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcInGuaranteedBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '4'
                  color: FC6EA3
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcInMaxBandwidth.[{$IF_IN_ID1}.{#SNMPINDEX}]'
                -
                  sortorder: '5'
                  color: 6C59DC
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfBcInDrops.[{$IF_IN_ID1}.{#SNMPINDEX}]'
        -
          name: 'CPU Cores Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CPU_ID},1.3.6.1.4.1.12356.101.4.4.2.1.1,{#CPU_TYPE},1.3.6.1.4.1.12356.101.4.4.2.1.4]'
          key: fgProcessorEntIndex.discovery
          delay: 1h
          filter:
            conditions:
              -
                macro: '{#CPU_TYPE}'
                value: 12356.101.4.4.3.1
                formulaid: A
              -
                macro: '{#CPU_TYPE}'
                value: 12356.101.4.4.3.2
                formulaid: B
              -
                macro: '{#CPU_TYPE}'
                value: 12356.101.4.4.3.3
                formulaid: C
          description: |
            FORTINET-FORTIGATE-MIB::fgProcessorEntIndex
            
            A unique identifier within the fgProcessorTable
          item_prototypes:
            -
              name: 'Average Usage of System Process over 1min per Core #{#CPU_ID}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.10.{#CPU_ID}'
              key: 'fgProcessorSysUsage.[{#CPU_ID}]'
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorSysUsage
                
                The processor's CPU system space usage, which is an average
                calculated over the last minute.
                (only valid for processors types that support this statistic).
              tags:
                -
                  tag: Application
                  value: CPU
            -
              name: 'Core #{#CPU_ID} Processor Type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.4.{#CPU_ID}'
              key: 'fgProcessorType.[{#CPU_ID}]'
              delay: 1h
              trends: '0'
              value_type: TEXT
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorType
                
                An indication of the type of the processor. Types are defined in fgProcessorTypes.
              tags:
                -
                  tag: Application
                  value: CPU
            -
              name: 'Average Usage over 1min per Core #{#CPU_ID}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.2.{#CPU_ID}'
              key: 'fgProcessorUsage.[{#CPU_ID}]'
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorUsage
                
                The processor's CPU usage (percentage), which is an average
                calculated over the last minute.
                (only valid for processors types that support this statistic).
              tags:
                -
                  tag: Application
                  value: CPU
            -
              name: 'Average Usage over 5sec per Core #{#CPU_ID}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.3.{#CPU_ID}'
              key: 'fgProcessorUsage5sec.[{#CPU_ID}]'
              delay: 5s
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorUsage5sec
                
                The processor's CPU usage (percentage), which is an average
                calculated over the last 5 sec.
                (only valid for processors types that support this statistic).
              tags:
                -
                  tag: Application
                  value: CPU
            -
              name: 'Average Usage of User Process over 1min per Core #{#CPU_ID}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.9.{#CPU_ID}'
              key: 'fgProcessorUserUsage.[{#CPU_ID}]'
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorUserUsage
                
                The processor's CPU user space usage, which is an average 
                calculated over the last minute.
                (only valid for processors types that support this statistic).
              tags:
                -
                  tag: Application
                  value: CPU
          graph_prototypes:
            -
              name: 'Average Usage over 1m and 5s per Core - Core #{#CPU_ID}'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorUsage.[{#CPU_ID}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorUsage5sec.[{#CPU_ID}]'
            -
              name: 'CPU usage per core - Core #{#CPU_ID}'
              type: STACKED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorSysUsage.[{#CPU_ID}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorUserUsage.[{#CPU_ID}]'
        -
          name: 'SoC3 Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CPU_ID},1.3.6.1.4.1.12356.101.4.4.2.1.1,{#CPU_TYPE},1.3.6.1.4.1.12356.101.4.4.2.1.4]'
          key: fgProcessorEntIndex.NP6LITE.discovery
          delay: 1h
          filter:
            conditions:
              -
                macro: '{#CPU_TYPE}'
                value: 12356.101.4.4.3.9
                formulaid: A
          description: |
            FORTINET-FORTIGATE-MIB::fgProcessorEntIndex
            
            A unique identifier within the fgProcessorTable
          item_prototypes:
            -
              name: 'SOC3 Packets Dropped'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.8.{#CPU_ID}'
              key: 'fgProcessorPktDroppedCount.[{#CPU_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorPktDroppedCount
                
                The total number of packets dropped by this processor
                (only valid for processors types that support this statistic).
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: SoC3
            -
              name: 'SOC3 Packets Received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.6.{#CPU_ID}'
              key: 'fgProcessorPktRxCount.[{#CPU_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorPktRxCount
                
                The total number of packets received by this processor
                (only valid for processors types that support this statistic).
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: SoC3
            -
              name: 'SOC3 Packets Transmitted'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.4.2.1.7.{#CPU_ID}'
              key: 'fgProcessorPktTxCount.[{#CPU_ID}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgProcessorPktTxCount
                
                The total number of packets transmitted by this processor
                (only valid for processors types that support this statistic).
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: SoC3
          graph_prototypes:
            -
              name: 'SoC3 Packet Flow - {#CPU_ID}'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorPktDroppedCount.[{#CPU_ID}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorPktRxCount.[{#CPU_ID}]'
                -
                  sortorder: '2'
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgProcessorPktTxCount.[{#CPU_ID}]'
        -
          name: 'Switch Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.12356.101.24.1.1.1.3.1,{#SNMPVALUENAME},.1.3.6.1.4.1.12356.101.24.1.1.1.4.1]'
          key: fgSwDeviceId.discovery
          delay: 1h
          lifetime: '0'
          description: |
            FORTINET-FORTIGATE-MIB:: fgSwDeviceId
            
            Switch device ID.
          item_prototypes:
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - Authorization'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.6.1.{#SNMPINDEX}'
              key: 'fgSwDeviceAuthorized[{#SNMPINDEX}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceAuthorized
                
                Switch device connection admin state.
                
                 INTEGER {discovered(0), disabled(1), authorized(2) }
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::fgSwDeviceAuthorized'
              tags:
                -
                  tag: Application
                  value: Switch
              trigger_prototypes:
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceAuthorized[{#SNMPINDEX}])<2'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceAuthorized[{#SNMPINDEX}])=2'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} is not authorized'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Status not authorized (discovered or disabled).'
                  manual_close: 'YES'
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - Flag'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.10.1.{#SNMPINDEX}'
              key: 'fgSwDeviceFlag[{#SNMPINDEX}]'
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceFlag
                
                Switch device transaction flag (C=config sync, U=upgrading, S=staged, D=delay reboot pending, E=config sync error).
              tags:
                -
                  tag: Application
                  value: Switch
              trigger_prototypes:
                -
                  expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","E")=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","-")=1'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} has config sync error'
                  priority: WARNING
                  manual_close: 'YES'
                -
                  expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","D")=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","-")=1'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} has delay reboot pending'
                  priority: INFO
                  description: 'Device has delay reboot pending.'
                  manual_close: 'YES'
                -
                  expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","S")=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","-")=1'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} is staging'
                  priority: INFO
                  description: 'Device is staging.'
                  manual_close: 'YES'
                -
                  expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","C")=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'find(/Template Net Fortinet FortiGate SNMP/fgSwDeviceFlag[{#SNMPINDEX}],,"iregexp","-")=1'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} is syncing config'
                  priority: INFO
                  description: 'Device is syncing configuration.'
                  manual_close: 'YES'
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - IP Address'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.9.1.{#SNMPINDEX}'
              key: 'fgSwDeviceIp[{#SNMPINDEX}]'
              delay: 1h
              trends: '0'
              value_type: TEXT
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceIp
                
                Switch device IP address.
              tags:
                -
                  tag: Application
                  value: Switch
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - Join time'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.8.1.{#SNMPINDEX}'
              key: 'fgSwDeviceJoinTime[{#SNMPINDEX}]'
              delay: 1h
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceJoinTime
                
                Time switch device become online.
              tags:
                -
                  tag: Application
                  value: Switch
              trigger_prototypes:
                -
                  expression: 'now()-last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceJoinTime[{#SNMPINDEX}])<{$JOINPERIOD}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'now()-last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceJoinTime[{#SNMPINDEX}])>{$JOINPERIOD}'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} has joined recently'
                  priority: INFO
                  description: 'Device joined to the network.'
                  manual_close: 'YES'
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - Serial Number'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.3.1.{#SNMPINDEX}'
              key: 'fgSwDeviceSerialNum[{#SNMPINDEX}]'
              delay: 1h
              trends: '0'
              value_type: TEXT
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceSerialNum
                
                Switch device serial number.
              tags:
                -
                  tag: Application
                  value: Switch
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - Administrative Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.7.1.{#SNMPINDEX}'
              key: 'fgSwDeviceStatus[{#SNMPINDEX}]'
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceStatus
                
                Switch device connection status.
                
                 INTEGER {down(0), up(1) }
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::fgSwDeviceStatus'
              tags:
                -
                  tag: Application
                  value: Switch
              trigger_prototypes:
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceStatus[{#SNMPINDEX}])=0'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceStatus[{#SNMPINDEX}])=1'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} is DOWN'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'Device status is down.'
                  manual_close: 'YES'
            -
              name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) - Firmware Version'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.24.1.1.1.5.1.{#SNMPINDEX}'
              key: 'fgSwDeviceVersion[{#SNMPINDEX}]'
              delay: 1h
              trends: '0'
              value_type: TEXT
              description: |
                FORTINET-FORTIGATE-MIB::fgSwDeviceVersion
                
                Switch device software version.
              tags:
                -
                  tag: Application
                  value: Switch
              trigger_prototypes:
                -
                  expression: '(last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceVersion[{#SNMPINDEX}],#1)<>last(/Template Net Fortinet FortiGate SNMP/fgSwDeviceVersion[{#SNMPINDEX}],#2))>0'
                  name: 'FortiSW {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} has changed firmware'
                  opdata: 'FW: {ITEM.LASTVALUE1}'
                  priority: INFO
                  description: 'Firmware was changed.'
                  manual_close: 'YES'
        -
          name: 'Virtual Domain Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VDOM_ID},1.3.6.1.4.1.12356.101.3.2.1.1.1,{#VDOM_NAME},1.3.6.1.4.1.12356.101.3.2.1.1.2]'
          key: fgVdEntIndex.discovery
          delay: 1h
          lifetime: '0'
          description: |
            FORTINET-FORTIGATE-MIB::fgVdEntIndex
            
            Internal virtual domain index used to uniquely identify rows in this table. This index is also used by other tables referencing a virtual domain.
          item_prototypes:
            -
              name: 'VDOM {#VDOM_NAME} - CPU Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.5.{#VDOM_ID}'
              key: 'fgVdEntCpuUsage.[{#VDOM_ID}]'
              history: 7d
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntCpuUsage
                
                CPU usage of the virtual domain (percentage).
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
            -
              name: 'VDOM {#VDOM_NAME} - HA Member State'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.4.{#VDOM_ID}'
              key: 'fgVdEntHaState.[{#VDOM_ID}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntHaState
                
                HA cluster member state of the virtual domain on this device
                (master, backup or standalone)
              valuemap:
                name: 'FORTINET-CORE-MIB::FgHaState'
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
            -
              name: 'VDOM {#VDOM_NAME} - Memory Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.6.{#VDOM_ID}'
              key: 'fgVdEntMemUsage.[{#VDOM_ID}]'
              history: 7d
              units: '%'
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntMemUsage
                
                Memory usage of the virtual domain (percentage).
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
            -
              name: 'VDOM #{#VDOM_ID} - Name'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.2.{#VDOM_ID}'
              key: 'fgVdEntName.[{#VDOM_ID}]'
              delay: 1h
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntName
                
                The name of the virtual domain
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
            -
              name: 'VDOM {#VDOM_NAME} - Operation Mode'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.3.{#VDOM_ID}'
              key: 'fgVdEntOpMode.[{#VDOM_ID}]'
              delay: 1h
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntOpMode
                
                Operation mode of the virtual domain (NAT or Transparent)
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::FgOpMode'
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
            -
              name: 'VDOM {#VDOM_NAME} - Active Sessions'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.7.{#VDOM_ID}'
              key: 'fgVdEntSesCount.[{#VDOM_ID}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntSesCount
                
                Number of active sessions on the virtual domain.
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
            -
              name: 'VDOM {#VDOM_NAME} - Session Rate'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.3.2.1.1.8.{#VDOM_ID}'
              key: 'fgVdEntSesRate.[{#VDOM_ID}]'
              history: 7d
              units: 'Sessions Per Second'
              description: |
                FORTINET-FORTIGATE-MIB::fgVdEntSesRate
                
                The session setup rate on the virtual domain.
              tags:
                -
                  tag: Application
                  value: 'Virtual Domain - {#VDOM_NAME}'
        -
          uuid: 2be041d47e4a49f797df925e8616538e
          name: 'VPN Phase 2'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.12356.101.12.2.2.1.3]'
          key: fgVpnTunEntPhase2Name
          item_prototypes:
            -
              uuid: c0764c0381e54a1c93c6bd39c87b96d0
              name: '{#SNMPVALUE}: Tunnel Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.12.2.2.1.20.{#SNMPINDEX}'
              key: 'fgVpnTunEntStatus[{#SNMPVALUE}]'
              trigger_prototypes:
                -
                  uuid: 0dcfd00939f44994a288cafc8a9d6a52
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgVpnTunEntStatus[{#SNMPVALUE}],#1)=1'
                  name: 'VPN Tunnel Down [{#SNMPVALUE}]'
                  priority: HIGH
                  description: 'IPsec VPN Tunnel Phase 2 is down, please check!'
                  manual_close: 'YES'
        -
          name: 'SD-WAN Health Check Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#HC_ID},1.3.6.1.4.1.12356.101.4.9.2.1.1,{#HC_NAME},1.3.6.1.4.1.12356.101.4.9.2.1.2,{#MEMBER_SEQ},1.3.6.1.4.1.12356.101.4.9.2.1.3,{#VDOM},1.3.6.1.4.1.12356.101.4.9.2.1.10]'
          key: fgVWLHealthCheckLink.discovery
          delay: 1h
          lifetime: '0'
          item_prototypes:
            -
              name: 'Available Bidirectional Bandwidth of Performance SLA {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.13.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkBandwidthBi.[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              units: B
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkBandwidthBi
                
                The available bandwidth in Mbps of bi-direction traffic detected by a health-check on a specific member link.
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Available Incoming Bandwidth of Performance SLA {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.11.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkBandwidthIn.[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              units: B
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkBandwidthIn
                
                The available bandwidth in Mbps of incoming traffic detected by a health-check on a specific member link.
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Available Outgoing Bandwidth of Performance SLA {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.12.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkBandwidthOut.[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              units: B
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkBandwidthOut
                
                The available bandwidth in Mbps of outgoing traffic detected by a health-check on a specific member link.
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Jitter to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.6.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkJitter[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              units: ms
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Latency to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.5.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkLatency[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              units: ms
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Packet Loss to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.9.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkPacketLoss[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              units: '%'
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Packets received from {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.8.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkPacketRecv[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkPacketRecv
                
                The total number of packets received by a health check on a specific member link.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Packets sent to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.7.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkPacketSend[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              value_type: FLOAT
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkPacketSend
                
                The total number of packets sent by a health check on a specific member link.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: SD-WAN
            -
              name: 'Health Check State to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.4.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkState[{#HC_ID}]'
              delay: 30s
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkState
                
                Heatlth check state on a specific member link.
              valuemap:
                name: 'Alarm state'
              tags:
                -
                  tag: Application
                  value: SD-WAN
              trigger_prototypes:
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgVWLHealthCheckLinkState[{#HC_ID}])=1 and (last(/Template Net Fortinet FortiGate SNMP/fgVWLHealthCheckLinkState[{#HC_ID}],#1)<>last(/Template Net Fortinet FortiGate SNMP/fgVWLHealthCheckLinkState[{#HC_ID}],#2))=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/fgVWLHealthCheckLinkState[{#HC_ID}])=0'
                  name: 'Health Check State Failed to {#HC_NAME} on member {#MEMBER_SEQ}'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  manual_close: 'YES'
            -
              name: 'VDOM of Performance SLA {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.4.9.2.1.10.{#HC_ID}'
              key: 'fgVWLHealthCheckLinkVdom.[{#HC_NAME}.{#MEMBER_SEQ}]'
              delay: 30s
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgVWLHealthCheckLinkVdom
                
                Virtual domain the link monitor entry exists in. This name corresponds to the fgVdEntName used in fgVdTable.
              tags:
                -
                  tag: Application
                  value: SD-WAN
          graph_prototypes:
            -
              name: 'Performance SLA Metrics to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgVWLHealthCheckLinkJitter[{#HC_NAME}.{#MEMBER_SEQ}]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgVWLHealthCheckLinkLatency[{#HC_NAME}.{#MEMBER_SEQ}]'
                -
                  sortorder: '2'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgVWLHealthCheckLinkPacketLoss[{#HC_NAME}.{#MEMBER_SEQ}]'
            -
              name: 'Probe Packets to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
              ymin_type_1: FIXED
              graph_items:
                -
                  color: 199C0D
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgVWLHealthCheckLinkPacketRecv[{#HC_NAME}.{#MEMBER_SEQ}]'
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgVWLHealthCheckLinkPacketSend[{#HC_NAME}.{#MEMBER_SEQ}]'
        -
          name: 'Wireless Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.12356.101.14.4.3.1.1,{#SNMPVALUENAME},.1.3.6.1.4.1.12356.101.14.4.3.1.3]'
          key: fgWcWtpConfigWtpId.discovery
          delay: 1h
          lifetime: '0'
          description: |
            FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpId
            
            Represents the unique identifier of a WTP.
          item_prototypes:
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Background Scan'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.12.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioApScan.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioApScan
                
                Whether background scan is enabled on this WTP.
              valuemap:
                name: 'FORTINET-CORE-MIB::FnBoolState'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Radio Tx Automatic Power Control'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.7.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioAutoTxPowerControl.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioAutoTxPowerControl
                
                Whether radio automatic TX power control is enabled on this WTP.
              valuemap:
                name: 'FORTINET-CORE-MIB::FnBoolState'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Radio Tx Automatic Power Control (High Limit)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.9.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioAutoTxPowerHigh.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioAutoTxPowerHigh
                
                Represents the high limit of radio automatic TX power control configured for this WTP, in dBm.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Radio Tx Automatic Power Control (Low Limit)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.8.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioAutoTxPowerLow.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioAutoTxPowerLow
                
                Represents the low limit of radio automatic TX power control configured for this WTP, in dBm.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Radio Band'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.11.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioBand.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioBand
                
                Represents the radio band configured for this WTP.
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::FgWcWtpRadioBandType'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Radio Enabled'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.6.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioEnable.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioEnable
                
                Whether radio is enabled for this WTP.
              valuemap:
                name: 'FORTINET-CORE-MIB::FnBoolState'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Radio Tx Power Level'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.10.{#SNMPINDEX}'
              key: 'fgWcWtpConfigRadioTxPowerLevel.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigRadioTxPowerLevel
                
                Represents the radio TX power setting configured for this WTP, in percentage.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - VAPs (All)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.13.{#SNMPINDEX}'
              key: 'fgWcWtpConfigVapAll.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigVapAll
                
                Whether all VAPs are selected for this WTP.
              valuemap:
                name: 'FORTINET-CORE-MIB::FnBoolState'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - VAPs (List)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.14.{#SNMPINDEX}'
              key: 'fgWcWtpConfigVaps.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigVaps
                
                Represents a list of VAPs configured for this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Administrative Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.2.{#SNMPINDEX}'
              key: 'fgWcWtpConfigWtpAdmin.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpAdmin
                
                Represents the administrative status of this WTP.
                
                discovered(1) - This WTP was discovered though discovery or join request messages.
                disable(2) - Controller is configured to not provide service to this WTP.
                enable(3) - Controller is configured to provide service to this WTP.
                other(0) - The administration state of the WTP is unknown.
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpAdmin'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Serial Number'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.1.{#SNMPINDEX}'
              key: 'fgWcWtpConfigWtpId.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpId
                
                Represents the unique identifier of a WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Location'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.4.{#SNMPINDEX}'
              key: 'fgWcWtpConfigWtpLocation.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpLocation
                
                Represents the location of this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Name'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.3.{#SNMPINDEX}'
              key: 'fgWcWtpConfigWtpName[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpName
                
                Represents the name configured for this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Profile'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.3.1.5.{#SNMPINDEX}'
              key: 'fgWcWtpConfigWtpProfile.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpProfile
                
                Represents the WTP profile configured for this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.7.{#SNMPINDEX}'
              key: 'fgWcWtpSessionConnectionState[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionConnectionState
                
                Represents the connection state of a WTP to AC.
                
                The following enumerated values are supported:
                
                offLine(1) - The WTP is not connected.
                onLine(2) - The WTP is connected.
                downloadingImage(3) - The WTP is downloading software image from the AC on joining.
                connectedImage(4) - The AC is pushing software image to the connected WTP.
                other(0) - The WTP connection state is unknown.
              valuemap:
                name: 'FORTINET-FORTIGATE-MIB::fgWcWtpSessionConnectionState'
              tags:
                -
                  tag: Application
                  value: Wireless
              trigger_prototypes:
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionConnectionState[{#SNMPVALUE}])=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionConnectionState[{#SNMPVALUE}])=2'
                  name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} is DOWN'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  manual_close: 'YES'
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionConnectionState[{#SNMPVALUE}])=3'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionConnectionState[{#SNMPVALUE}])=2'
                  name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) is receiving firmware update from {HOST.NAME}'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: INFO
                  manual_close: 'YES'
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionConnectionState[{#SNMPVALUE}])=4'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionConnectionState[{#SNMPVALUE}])=2'
                  name: '{HOST.NAME} is sending firmware to FortiAP {#SNMPVALUE} ({#SNMPVALUENAME})'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: INFO
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Base MAC Address'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.6.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpBaseMacAddress.[{#SNMPVALUE}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpBaseMacAddress
                
                Represents the WTP's Base MAC Address, which MAY be assigned to the primary
                Ethernet interface.
                The instance of the object corresponds to the Base MAC Address sub-element
                in the CAPWAP protocol [RFC5415].
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Version (Bootloader)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.15.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpBootVersion.[{#SNMPVALUE}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpBootVersion
                
                Represents the boot loader version of a WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Byte Count Rate (Rx)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.18.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpByteRxCount.rate.[{#SNMPVALUE}]'
              history: 7d
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpByteRxCount
                
                Represents the number of bytes received by this WTP.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Byte Count Rate (Tx)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.19.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpByteTxCount.rate.[{#SNMPVALUE}]'
              history: 7d
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpByteTxCount
                
                Represents the number of bytes transmitted by this WTP.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - CPU Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.20.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpCpuUsage.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpCpuUsage
                
                Represents the current CPU usage of a WTP (percentage).
              tags:
                -
                  tag: Application
                  value: Wireless
              trigger_prototypes:
                -
                  expression: 'min(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpCpuUsage.[{#SNMPVALUE}],5m)>{$CPU.UTIL.CRIT}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpCpuUsage.[{#SNMPVALUE}],5m)<{$CPU.UTIL.CRIT}'
                  name: 'High CPU usage (over {$CPU.UTIL.CRIT}% for 5m) - FortiAP {#SNMPVALUE} ({#SNMPVALUENAME})'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Uptime (Daemon)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.9.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpDaemonUpTime.[{#SNMPVALUE}]'
              history: 7d
              units: uptime
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpDaemonUpTime
                
                Represents the time (in hundredths of a second) since the WTP daemon has been started.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Version (Hardware)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.13.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpHwVersion.[{#SNMPVALUE}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpHwVersion
                
                Represents the hardware version of a WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - IP Address'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.3.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpIpAddress.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpIpAddress
                
                Represents the IP address of a WTP that corresponds to the IP address in the IP packet header.
                
                The format of this IP address is determined by the corresponding instance of object gWcWtpWtpIpAddressType.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - IP Address Type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.2.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpIpAddressType.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpIpAddressType
                
                Represents the IP address type of a WTP.
                Only ipv4(1) and ipv6(2) are supported by the object.
              valuemap:
                name: 'IF-MIB::InetAddressType'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Local IP Address'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.5.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpLocalIpAddress.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpLocalIpAddress
                
                Represents the local IP address of a WTP and models the CAPWAP Local IPv4 Address
                or CAPWAP Local IPv6 Address fields [RFC5415].
                If a Network Address Translation (NAT) device is present between WTP and AC, the value of
                fgWcWtpWtpLocalIpAddress will be different from the value of fgWcWtpWtpIpAddress.
                The format of this IP address is determined by the corresponding instance of object
                fgWcWtpSessionWtpLocalIpAddressType.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Local IP Address Type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.4.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpLocalIpAddressType.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpLocalIpAddressType
                
                Represents the local IP address type of a WTP.
                Only ipv4(1) and ipv6(2) are supported by the object.
              valuemap:
                name: 'IF-MIB::InetAddressType'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Memory Capacity'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.22.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpMemoryCapacity.[{#SNMPVALUE}]'
              delay: 1h
              history: 7d
              units: B
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpMemoryCapacity
                
                Represents the total physical memory (RAM) installed (KB).
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1024'
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Memory Usage'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.21.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpMemoryUsage.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpCpuUsage
                
                Represents the current memory usage of a WTP (percentage).
              tags:
                -
                  tag: Application
                  value: Wireless
              trigger_prototypes:
                -
                  expression: 'min(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpMemoryUsage.[{#SNMPVALUE}],5m)>{$MEMORY.UTIL.MAX}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'max(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpMemoryUsage.[{#SNMPVALUE}],5m)<{$MEMORY.UTIL.MAX}'
                  name: 'High memory usage (over {$MEMORY.UTIL.MAX}% for 5m) - FortiAP {#SNMPVALUE} ({#SNMPVALUENAME})'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'The system is running out of free memory.'
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Model Number'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.12.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpModelNumber.[{#SNMPVALUE}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpModelNumber
                
                Represents the model number of a WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Profile Name'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.11.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpProfileName.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpProfileName
                
                Represents the profile configured for this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Region Code'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.16.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpRegionCode.[{#SNMPVALUE}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpRegionCode
                
                Represents the region code programmed for this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Uptime (Session)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.10.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpSessionUpTime.[{#SNMPVALUE}]'
              history: 7d
              units: uptime
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpSessionUpTime
                
                Represents the time (in hundredths of a second) since the WTP connects to the AC.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: Wireless
              trigger_prototypes:
                -
                  expression: 'change(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpSessionUpTime.[{#SNMPVALUE}])<0'
                  name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) session with {HOST.NAME} has been restarted'
                  opdata: 'Status: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Session between FAP and FG was restarted. Ack to close.'
                  manual_close: 'YES'
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Connected Clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.17.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpStationCount.[{#SNMPVALUE}]'
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpStationCount
                
                Represents the number of clients currently connected to this WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Version (Software)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.14.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpSwVersion[{#SNMPVALUE}]'
              delay: 1h
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpSwVersion
                
                Represents the software version of a WTP.
              tags:
                -
                  tag: Application
                  value: Wireless
              trigger_prototypes:
                -
                  expression: '(last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpSwVersion[{#SNMPVALUE}],#1)<>last(/Template Net Fortinet FortiGate SNMP/fgWcWtpSessionWtpSwVersion[{#SNMPVALUE}],#2))>0'
                  name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) in {HOST.NAME} has changed firmware'
                  opdata: 'FW: {ITEM.LASTVALUE1}'
                  priority: INFO
                  description: 'Firmware was changed.'
                  manual_close: 'YES'
            -
              name: 'FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) - Uptime'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.14.4.4.1.8.{#SNMPINDEX}'
              key: 'fgWcWtpSessionWtpUpTime.[{#SNMPVALUE}]'
              history: 7d
              units: uptime
              description: |
                FORTINET-FORTIGATE-MIB::fgWcWtpSessionWtpUpTime
                
                Represents the time (in hundredths of a second) since the WTP boots.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: Wireless
          graph_prototypes:
            -
              name: 'Wireless - FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) Byte Count Rate (Tx/Rx)'
              ymin_type_1: FIXED
              graph_items:
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgWcWtpSessionWtpByteRxCount.rate.[{#SNMPVALUE}]'
                -
                  sortorder: '2'
                  color: A54F10
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgWcWtpSessionWtpByteTxCount.rate.[{#SNMPVALUE}]'
            -
              name: 'Wireless - FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) Clients'
              ymin_type_1: FIXED
              graph_items:
                -
                  sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgWcWtpSessionWtpStationCount.[{#SNMPVALUE}]'
            -
              name: 'Wireless - FortiAP {#SNMPVALUE} ({#SNMPVALUENAME}) Health'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                -
                  sortorder: '1'
                  color: F63100
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgWcWtpSessionWtpCpuUsage.[{#SNMPVALUE}]'
                -
                  sortorder: '2'
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgWcWtpSessionWtpMemoryUsage.[{#SNMPVALUE}]'
        -
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              -
                macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: I
              -
                macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: J
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: G
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              -
                macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: E
              -
                macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              -
                macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              -
                macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
                formulaid: K
              -
                macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: L
          description: |
            Discovering interfaces from IF-MIB.
            
            +
            
            FORTINET-FORTIGATE-MIB::fgIntfEntry
            
            Fortinet specific extensions to MIB-2 ifTable.
            
            Fortinet specific information about an ifEntry. This table augments the standard ifTable, so the same indexing is used.
          item_prototypes:
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Estimated downstream bandwidth'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.2.1.1.3.{#SNMPINDEX}'
              key: 'fgIntfEntEstDownBandwidth.[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfEntEstDownBandwidth
                
                Estimated maximum downstream bandwidth (Kbps). Used to estimate link utilization.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Estimated upstream bandwidth'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.2.1.1.2.{#SNMPINDEX}'
              key: 'fgIntfEntEstUpBandwidth.[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              units: bps
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfEntEstUpBandwidth
                
                Estimated maximum upstream bandwidth (Kbps). Used to estimate link utilization.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): VDOM'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.12356.101.7.2.1.1.1.{#SNMPINDEX}'
              key: 'fgIntfEntVdom.[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              description: |
                FORTINET-FORTIGATE-MIB::fgIntfEntVdom
                
                The virtual domain the interface belongs to. This index corresponds to the index used by fgVdTable.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Duplex status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}'
              key: 'net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]'
              history: 7d
              description: |
                MIB: EtherLike-MIB
                The current mode of operation of the MAC
                entity.  'unknown' indicates that the current
                duplex mode could not be determined.
                
                Management control of the duplex mode is
                accomplished through the MAU MIB.  When
                an interface does not support autonegotiation,
                or when autonegotiation is not enabled, the
                duplex mode is controlled using
                ifMauDefaultType.  When autonegotiation is
                supported and enabled, duplex mode is controlled
                using ifMauAutoNegAdvertisedBits.  In either
                case, the currently operating duplex mode is
                reflected both in this object and in ifMauType.
                
                Note that this object provides redundant
                information with ifMauType.  Normally, redundant
                objects are discouraged.  However, in this
                instance, it allows a management application to
                determine the duplex status of an interface
                without having to know every possible value of
                ifMauType.  This was felt to be sufficiently
                valuable to justify the redundancy.
                Reference: [IEEE 802.3 Std.], 30.3.1.1.32,aDuplexStatus.
              valuemap:
                name: 'EtherLike-MIB::dot3StatsDuplexStatus'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  expression: 'last(/Template Net Fortinet FortiGate SNMP/net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}])=2'
                  name: 'Interface {#IFNAME}({#IFALIAS}): In half-duplex mode'
                  priority: WARNING
                  description: 'Please check autonegotiation settings and cabling'
                  manual_close: 'YES'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: 0d
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000000'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  manual_close: 'YES'
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              trends: 0d
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned NumbersAuthority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
          trigger_prototypes:
            -
              expression: |
                change(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/Template Net Fortinet FortiGate SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/Template Net Fortinet FortiGate SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/Template Net Fortinet FortiGate SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/Template Net Fortinet FortiGate SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/Template Net Fortinet FortiGate SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/Template Net Fortinet FortiGate SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
            -
              expression: |
                (avg(/Template Net Fortinet FortiGate SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Template Net Fortinet FortiGate SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Template Net Fortinet FortiGate SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Template Net Fortinet FortiGate SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Template Net Fortinet FortiGate SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}% )'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
            -
              expression: |
                min(/Template Net Fortinet FortiGate SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Template Net Fortinet FortiGate SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Template Net Fortinet FortiGate SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Template Net Fortinet FortiGate SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Template Net Fortinet FortiGate SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
          graph_prototypes:
            -
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                -
                  sortorder: '3'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                -
                  sortorder: '4'
                  color: A54F10
                  yaxisside: RIGHT
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                -
                  sortorder: '5'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                -
                  sortorder: '6'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
                -
                  sortorder: '7'
                  color: AC8C14
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfEntEstDownBandwidth.[{#SNMPINDEX}]'
                -
                  sortorder: '8'
                  color: 611F27
                  item:
                    host: 'Template Net Fortinet FortiGate SNMP'
                    key: 'fgIntfEntEstUpBandwidth.[{#SNMPINDEX}]'
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '80'
          description: 'High CPU usage trigger threshold'
        -
          macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'High ICMP ping loss trigger threshold'
        -
          macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'High ICMP ping response time trigger threshold (s)'
        -
          macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'High error rate trigger threshold'
        -
          macro: '{$IF.UTIL.MAX}'
          value: '90'
          description: 'High bandwidth usage trigger threshold'
        -
          macro: '{$IFCONTROL}'
          value: '1'
          description: 'Control if up-down state change will trigger'
        -
          macro: '{$IF_ID1}'
          value: '1'
          description: 'Interface ID where Egress Shaping is configured'
        -
          macro: '{$IF_IN_ID1}'
          value: '2'
          description: 'Interface ID where Ingress Shaping is configured'
        -
          macro: '{$JOINPERIOD}'
          value: '3600'
          description: 'FortiSW join time information (in seconds)'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '80'
          description: 'High memory usage trigger threshold'
        -
          macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Ignore notPresent(6) - LOOKS WRONG'
        -
          macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        -
          macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Match all by default'
        -
          macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Change to exclude interfaces from discovery'
        -
          macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Match all by default'
        -
          macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Change to exclude interfaces from discovery'
        -
          macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
          description: 'Match all by default'
        -
          macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        -
          macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '1'
          description: 'Interfaces with up(1) Operational Status are discovered.'
        -
          macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        -
          macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
          description: 'Match all by default. Details at https://www.iana.org/assignments/ianaiftype-mib/ianaiftype-mib'
        -
          macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Change to exclude interfaces from discovery'
        -
          macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'No SNMP data collection trigger threshold'
      dashboards:
        -
          name: 'HA Statistics'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Concurrent Connections'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '5'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - CPU Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '10'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Memory Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '15'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Network Bandwidth Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '20'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Security Events Rate'
                        host: 'Template Net Fortinet FortiGate SNMP'
        -
          name: 'High Availability'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Concurrent Connections'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '5'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - CPU Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '10'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Memory Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '15'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Network Bandwidth Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_PROTOTYPE
                  'y': '20'
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'HA Cluster Member {#HA_ID} - Security Events Rate'
                        host: 'Template Net Fortinet FortiGate SNMP'
        -
          name: 'SD-WAN Performance SLA'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'Performance SLA Metrics to {#HC_NAME} on SD-WAN member {#MEMBER_SEQ}'
                        host: 'Template Net Fortinet FortiGate SNMP'
        -
          name: 'System Performance'
          pages:
            -
              widgets:
                -
                  type: GRAPH_CLASSIC
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        name: 'CPU usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_CLASSIC
                  x: '12'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        name: 'Memory usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_CLASSIC
                  'y': '5'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        name: 'Hard Disk Usage'
                        host: 'Template Net Fortinet FortiGate SNMP'
                -
                  type: GRAPH_CLASSIC
                  x: '12'
                  'y': '5'
                  width: '12'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '0'
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        name: 'ICMP response time'
                        host: 'Template Net Fortinet FortiGate SNMP'
      valuemaps:
        -
          name: 'Alarm state'
          mappings:
            -
              value: '0'
              newvalue: Ok
            -
              value: '1'
              newvalue: Alarm
        -
          name: 'EtherLike-MIB::dot3StatsDuplexStatus'
          mappings:
            -
              value: '1'
              newvalue: unknown
            -
              value: '2'
              newvalue: halfDuplex
            -
              value: '3'
              newvalue: fullDuplex
        -
          name: 'FORTINET-CORE-MIB::FgHaState'
          mappings:
            -
              value: '1'
              newvalue: master
            -
              value: '2'
              newvalue: backup
            -
              value: '3'
              newvalue: standalone
        -
          name: 'FORTINET-CORE-MIB::FnBoolState'
          mappings:
            -
              value: '1'
              newvalue: disabled
            -
              value: '2'
              newvalue: enabled
        -
          name: 'FORTINET-FORTIGATE-MIB::FgHaLBSchedule'
          mappings:
            -
              value: '1'
              newvalue: none
            -
              value: '2'
              newvalue: hub
            -
              value: '3'
              newvalue: leastConnections
            -
              value: '4'
              newvalue: roundRobin
            -
              value: '5'
              newvalue: weightedRoundRobin
            -
              value: '6'
              newvalue: random
            -
              value: '7'
              newvalue: ipBased
            -
              value: '8'
              newvalue: ipPortBased
        -
          name: 'FORTINET-FORTIGATE-MIB::FgHaMode'
          mappings:
            -
              value: '1'
              newvalue: standalone
            -
              value: '2'
              newvalue: activeActive
            -
              value: '3'
              newvalue: activePassive
        -
          name: 'FORTINET-FORTIGATE-MIB::FgHaStatsSyncStatusType'
          mappings:
            -
              value: '0'
              newvalue: unsynchronized
            -
              value: '1'
              newvalue: synchronized
        -
          name: 'FORTINET-FORTIGATE-MIB::FgOpMode'
          mappings:
            -
              value: '1'
              newvalue: nat
            -
              value: '2'
              newvalue: transparent
        -
          name: 'FORTINET-FORTIGATE-MIB::fgSwDeviceAuthorized'
          mappings:
            -
              value: '0'
              newvalue: discovered
            -
              value: '1'
              newvalue: disabled
            -
              value: '2'
              newvalue: authorized
        -
          name: 'FORTINET-FORTIGATE-MIB::fgSwDeviceStatus'
          mappings:
            -
              value: '0'
              newvalue: down
            -
              value: '1'
              newvalue: up
        -
          name: 'FORTINET-FORTIGATE-MIB::fgWcWtpConfigWtpAdmin'
          mappings:
            -
              value: '0'
              newvalue: other
            -
              value: '1'
              newvalue: discovered
            -
              value: '2'
              newvalue: disable
            -
              value: '3'
              newvalue: enable
        -
          name: 'FORTINET-FORTIGATE-MIB::FgWcWtpRadioBandType'
          mappings:
            -
              value: '0'
              newvalue: other
            -
              value: '1'
              newvalue: band2GHz
            -
              value: '2'
              newvalue: band5GHz
        -
          name: 'FORTINET-FORTIGATE-MIB::fgWcWtpSessionConnectionState'
          mappings:
            -
              value: '0'
              newvalue: other
            -
              value: '1'
              newvalue: offline
            -
              value: '2'
              newvalue: online
            -
              value: '3'
              newvalue: 'downloading Image'
            -
              value: '4'
              newvalue: 'connected Image'
        -
          name: 'IF-MIB::ifOperStatus'
          mappings:
            -
              value: '1'
              newvalue: up
            -
              value: '2'
              newvalue: down
            -
              value: '4'
              newvalue: unknown
            -
              value: '5'
              newvalue: dormant
            -
              value: '6'
              newvalue: notPresent
            -
              value: '7'
              newvalue: lowerLayerDown
        -
          name: 'IF-MIB::ifType'
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: regular1822
            -
              value: '3'
              newvalue: hdh1822
            -
              value: '4'
              newvalue: ddnX25
            -
              value: '5'
              newvalue: rfc877x25
            -
              value: '6'
              newvalue: ethernetCsmacd
            -
              value: '7'
              newvalue: iso88023Csmacd
            -
              value: '8'
              newvalue: iso88024TokenBus
            -
              value: '9'
              newvalue: iso88025TokenRing
            -
              value: '10'
              newvalue: iso88026Man
            -
              value: '11'
              newvalue: starLan
            -
              value: '12'
              newvalue: proteon10Mbit
            -
              value: '13'
              newvalue: proteon80Mbit
            -
              value: '14'
              newvalue: hyperchannel
            -
              value: '15'
              newvalue: fddi
            -
              value: '16'
              newvalue: lapb
            -
              value: '17'
              newvalue: sdlc
            -
              value: '18'
              newvalue: ds1
            -
              value: '19'
              newvalue: e1
            -
              value: '20'
              newvalue: basicISDN
            -
              value: '21'
              newvalue: primaryISDN
            -
              value: '22'
              newvalue: propPointToPointSerial
            -
              value: '23'
              newvalue: ppp
            -
              value: '24'
              newvalue: softwareLoopback
            -
              value: '25'
              newvalue: eon
            -
              value: '26'
              newvalue: ethernet3Mbit
            -
              value: '27'
              newvalue: nsip
            -
              value: '28'
              newvalue: slip
            -
              value: '29'
              newvalue: ultra
            -
              value: '30'
              newvalue: ds3
            -
              value: '31'
              newvalue: sip
            -
              value: '32'
              newvalue: frameRelay
            -
              value: '33'
              newvalue: rs232
            -
              value: '34'
              newvalue: para
            -
              value: '35'
              newvalue: arcnet
            -
              value: '36'
              newvalue: arcnetPlus
            -
              value: '37'
              newvalue: atm
            -
              value: '38'
              newvalue: miox25
            -
              value: '39'
              newvalue: sonet
            -
              value: '40'
              newvalue: x25ple
            -
              value: '41'
              newvalue: iso88022llc
            -
              value: '42'
              newvalue: localTalk
            -
              value: '43'
              newvalue: smdsDxi
            -
              value: '44'
              newvalue: frameRelayService
            -
              value: '45'
              newvalue: v35
            -
              value: '46'
              newvalue: hssi
            -
              value: '47'
              newvalue: hippi
            -
              value: '48'
              newvalue: modem
            -
              value: '49'
              newvalue: aal5
            -
              value: '50'
              newvalue: sonetPath
            -
              value: '51'
              newvalue: sonetVT
            -
              value: '52'
              newvalue: smdsIcip
            -
              value: '53'
              newvalue: propVirtual
            -
              value: '54'
              newvalue: propMultiplexor
            -
              value: '55'
              newvalue: ieee80212
            -
              value: '56'
              newvalue: fibreChannel
            -
              value: '57'
              newvalue: hippiInterface
            -
              value: '58'
              newvalue: frameRelayInterconnect
            -
              value: '59'
              newvalue: aflane8023
            -
              value: '60'
              newvalue: aflane8025
            -
              value: '61'
              newvalue: cctEmul
            -
              value: '62'
              newvalue: fastEther
            -
              value: '63'
              newvalue: isdn
            -
              value: '64'
              newvalue: v11
            -
              value: '65'
              newvalue: v36
            -
              value: '66'
              newvalue: g703at64k
            -
              value: '67'
              newvalue: g703at2mb
            -
              value: '68'
              newvalue: qllc
            -
              value: '69'
              newvalue: fastEtherFX
            -
              value: '70'
              newvalue: channel
            -
              value: '71'
              newvalue: ieee80211
            -
              value: '72'
              newvalue: ibm370parChan
            -
              value: '73'
              newvalue: escon
            -
              value: '74'
              newvalue: dlsw
            -
              value: '75'
              newvalue: isdns
            -
              value: '76'
              newvalue: isdnu
            -
              value: '77'
              newvalue: lapd
            -
              value: '78'
              newvalue: ipSwitch
            -
              value: '79'
              newvalue: rsrb
            -
              value: '80'
              newvalue: atmLogical
            -
              value: '81'
              newvalue: ds0
            -
              value: '82'
              newvalue: ds0Bundle
            -
              value: '83'
              newvalue: bsc
            -
              value: '84'
              newvalue: async
            -
              value: '85'
              newvalue: cnr
            -
              value: '86'
              newvalue: iso88025Dtr
            -
              value: '87'
              newvalue: eplrs
            -
              value: '88'
              newvalue: arap
            -
              value: '89'
              newvalue: propCnls
            -
              value: '90'
              newvalue: hostPad
            -
              value: '91'
              newvalue: termPad
            -
              value: '92'
              newvalue: frameRelayMPI
            -
              value: '93'
              newvalue: x213
            -
              value: '94'
              newvalue: adsl
            -
              value: '95'
              newvalue: radsl
            -
              value: '96'
              newvalue: sdsl
            -
              value: '97'
              newvalue: vdsl
            -
              value: '98'
              newvalue: iso88025CRFPInt
            -
              value: '99'
              newvalue: myrinet
            -
              value: '100'
              newvalue: voiceEM
            -
              value: '101'
              newvalue: voiceFXO
            -
              value: '102'
              newvalue: voiceFXS
            -
              value: '103'
              newvalue: voiceEncap
            -
              value: '104'
              newvalue: voiceOverIp
            -
              value: '105'
              newvalue: atmDxi
            -
              value: '106'
              newvalue: atmFuni
            -
              value: '107'
              newvalue: atmIma
            -
              value: '108'
              newvalue: pppMultilinkBundle
            -
              value: '109'
              newvalue: ipOverCdlc
            -
              value: '110'
              newvalue: ipOverClaw
            -
              value: '111'
              newvalue: stackToStack
            -
              value: '112'
              newvalue: virtualIpAddress
            -
              value: '113'
              newvalue: mpc
            -
              value: '114'
              newvalue: ipOverAtm
            -
              value: '115'
              newvalue: iso88025Fiber
            -
              value: '116'
              newvalue: tdlc
            -
              value: '117'
              newvalue: gigabitEthernet
            -
              value: '118'
              newvalue: hdlc
            -
              value: '119'
              newvalue: lapf
            -
              value: '120'
              newvalue: v37
            -
              value: '121'
              newvalue: x25mlp
            -
              value: '122'
              newvalue: x25huntGroup
            -
              value: '123'
              newvalue: trasnpHdlc
            -
              value: '124'
              newvalue: interleave
            -
              value: '125'
              newvalue: fast
            -
              value: '126'
              newvalue: ip
            -
              value: '127'
              newvalue: docsCableMaclayer
            -
              value: '128'
              newvalue: docsCableDownstream
            -
              value: '129'
              newvalue: docsCableUpstream
            -
              value: '130'
              newvalue: a12MppSwitch
            -
              value: '131'
              newvalue: tunnel
            -
              value: '132'
              newvalue: coffee
            -
              value: '133'
              newvalue: ces
            -
              value: '134'
              newvalue: atmSubInterface
            -
              value: '135'
              newvalue: l2vlan
            -
              value: '136'
              newvalue: l3ipvlan
            -
              value: '137'
              newvalue: l3ipxvlan
            -
              value: '138'
              newvalue: digitalPowerline
            -
              value: '139'
              newvalue: mediaMailOverIp
            -
              value: '140'
              newvalue: dtm
            -
              value: '141'
              newvalue: dcn
            -
              value: '142'
              newvalue: ipForward
            -
              value: '143'
              newvalue: msdsl
            -
              value: '144'
              newvalue: ieee1394
            -
              value: '145'
              newvalue: if-gsn
            -
              value: '146'
              newvalue: dvbRccMacLayer
            -
              value: '147'
              newvalue: dvbRccDownstream
            -
              value: '148'
              newvalue: dvbRccUpstream
            -
              value: '149'
              newvalue: atmVirtual
            -
              value: '150'
              newvalue: mplsTunnel
            -
              value: '151'
              newvalue: srp
            -
              value: '152'
              newvalue: voiceOverAtm
            -
              value: '153'
              newvalue: voiceOverFrameRelay
            -
              value: '154'
              newvalue: idsl
            -
              value: '155'
              newvalue: compositeLink
            -
              value: '156'
              newvalue: ss7SigLink
            -
              value: '157'
              newvalue: propWirelessP2P
            -
              value: '158'
              newvalue: frForward
            -
              value: '159'
              newvalue: rfc1483
            -
              value: '160'
              newvalue: usb
            -
              value: '161'
              newvalue: ieee8023adLag
            -
              value: '162'
              newvalue: bgppolicyaccounting
            -
              value: '163'
              newvalue: frf16MfrBundle
            -
              value: '164'
              newvalue: h323Gatekeeper
            -
              value: '165'
              newvalue: h323Proxy
            -
              value: '166'
              newvalue: mpls
            -
              value: '167'
              newvalue: mfSigLink
            -
              value: '168'
              newvalue: hdsl2
            -
              value: '169'
              newvalue: shdsl
            -
              value: '170'
              newvalue: ds1FDL
            -
              value: '171'
              newvalue: pos
            -
              value: '172'
              newvalue: dvbAsiIn
            -
              value: '173'
              newvalue: dvbAsiOut
            -
              value: '174'
              newvalue: plc
            -
              value: '175'
              newvalue: nfas
            -
              value: '176'
              newvalue: tr008
            -
              value: '177'
              newvalue: gr303RDT
            -
              value: '178'
              newvalue: gr303IDT
            -
              value: '179'
              newvalue: isup
            -
              value: '180'
              newvalue: propDocsWirelessMaclayer
            -
              value: '181'
              newvalue: propDocsWirelessDownstream
            -
              value: '182'
              newvalue: propDocsWirelessUpstream
            -
              value: '183'
              newvalue: hiperlan2
            -
              value: '184'
              newvalue: propBWAp2Mp
            -
              value: '185'
              newvalue: sonetOverheadChannel
            -
              value: '186'
              newvalue: digitalWrapperOverheadChannel
            -
              value: '187'
              newvalue: aal2
            -
              value: '188'
              newvalue: radioMAC
            -
              value: '189'
              newvalue: atmRadio
            -
              value: '190'
              newvalue: imt
            -
              value: '191'
              newvalue: mvl
            -
              value: '192'
              newvalue: reachDSL
            -
              value: '193'
              newvalue: frDlciEndPt
            -
              value: '194'
              newvalue: atmVciEndPt
            -
              value: '195'
              newvalue: opticalChannel
            -
              value: '196'
              newvalue: opticalTransport
            -
              value: '197'
              newvalue: propAtm
            -
              value: '198'
              newvalue: voiceOverCable
            -
              value: '199'
              newvalue: infiniband
            -
              value: '200'
              newvalue: teLink
            -
              value: '201'
              newvalue: q2931
            -
              value: '202'
              newvalue: virtualTg
            -
              value: '203'
              newvalue: sipTg
            -
              value: '204'
              newvalue: sipSig
            -
              value: '205'
              newvalue: docsCableUpstreamChannel
            -
              value: '206'
              newvalue: econet
            -
              value: '207'
              newvalue: pon155
            -
              value: '208'
              newvalue: pon622
            -
              value: '209'
              newvalue: bridge
            -
              value: '210'
              newvalue: linegroup
            -
              value: '211'
              newvalue: voiceEMFGD
            -
              value: '212'
              newvalue: voiceFGDEANA
            -
              value: '213'
              newvalue: voiceDID
            -
              value: '214'
              newvalue: mpegTransport
            -
              value: '215'
              newvalue: sixToFour
            -
              value: '216'
              newvalue: gtp
            -
              value: '217'
              newvalue: pdnEtherLoop1
            -
              value: '218'
              newvalue: pdnEtherLoop2
            -
              value: '219'
              newvalue: opticalChannelGroup
            -
              value: '220'
              newvalue: homepna
            -
              value: '221'
              newvalue: gfp
            -
              value: '222'
              newvalue: ciscoISLvlan
            -
              value: '223'
              newvalue: actelisMetaLOOP
            -
              value: '224'
              newvalue: fcipLink
            -
              value: '225'
              newvalue: rpr
            -
              value: '226'
              newvalue: qam
            -
              value: '227'
              newvalue: lmp
            -
              value: '228'
              newvalue: cblVectaStar
            -
              value: '229'
              newvalue: docsCableMCmtsDownstream
            -
              value: '230'
              newvalue: adsl2
            -
              value: '231'
              newvalue: macSecControlledIF
            -
              value: '232'
              newvalue: macSecUncontrolledIF
            -
              value: '233'
              newvalue: aviciOpticalEther
            -
              value: '234'
              newvalue: atmbond
            -
              value: '235'
              newvalue: voiceFGDOS
            -
              value: '236'
              newvalue: mocaVersion1
            -
              value: '237'
              newvalue: ieee80216WMAN
            -
              value: '238'
              newvalue: adsl2plus
            -
              value: '239'
              newvalue: dvbRcsMacLayer
            -
              value: '240'
              newvalue: dvbTdm
            -
              value: '241'
              newvalue: dvbRcsTdma
            -
              value: '242'
              newvalue: x86Laps
            -
              value: '243'
              newvalue: wwanPP
            -
              value: '244'
              newvalue: wwanPP2
            -
              value: '245'
              newvalue: voiceEBS
            -
              value: '246'
              newvalue: ifPwType
            -
              value: '247'
              newvalue: ilan
            -
              value: '248'
              newvalue: pip
            -
              value: '249'
              newvalue: aluELP
            -
              value: '250'
              newvalue: gpon
            -
              value: '251'
              newvalue: vdsl2
            -
              value: '252'
              newvalue: capwapDot11Profile
            -
              value: '253'
              newvalue: capwapDot11Bss
            -
              value: '254'
              newvalue: capwapWtpVirtualRadio
            -
              value: '255'
              newvalue: bits
            -
              value: '256'
              newvalue: docsCableUpstreamRfPort
            -
              value: '257'
              newvalue: cableDownstreamRfPort
            -
              value: '258'
              newvalue: vmwareVirtualNic
            -
              value: '259'
              newvalue: ieee802154
            -
              value: '260'
              newvalue: otnOdu
            -
              value: '261'
              newvalue: otnOtu
            -
              value: '262'
              newvalue: ifVfiType
            -
              value: '263'
              newvalue: g9981
            -
              value: '264'
              newvalue: g9982
            -
              value: '265'
              newvalue: g9983
            -
              value: '266'
              newvalue: aluEpon
            -
              value: '267'
              newvalue: aluEponOnu
            -
              value: '268'
              newvalue: aluEponPhysicalUni
            -
              value: '269'
              newvalue: aluEponLogicalLink
            -
              value: '270'
              newvalue: aluGponOnu
            -
              value: '271'
              newvalue: aluGponPhysicalUni
            -
              value: '272'
              newvalue: vmwareNicTeam
            -
              value: '277'
              newvalue: docsOfdmDownstream
            -
              value: '278'
              newvalue: docsOfdmaUpstream
            -
              value: '279'
              newvalue: gfast
            -
              value: '280'
              newvalue: sdci
            -
              value: '281'
              newvalue: xboxWireless
            -
              value: '282'
              newvalue: fastdsl
            -
              value: '283'
              newvalue: docsCableScte55d1FwdOob
            -
              value: '284'
              newvalue: docsCableScte55d1RetOob
            -
              value: '285'
              newvalue: docsCableScte55d2DsOob
            -
              value: '286'
              newvalue: docsCableScte55d2UsOob
            -
              value: '287'
              newvalue: docsCableNdf
            -
              value: '288'
              newvalue: docsCableNdr
            -
              value: '289'
              newvalue: ptm
            -
              value: '290'
              newvalue: ghn
        -
          name: 'IF-MIB::InetAddressType'
          mappings:
            -
              value: '1'
              newvalue: ipv4
            -
              value: '2'
              newvalue: ipv6
        -
          name: 'Service state'
          mappings:
            -
              value: '0'
              newvalue: Down
            -
              value: '1'
              newvalue: Up
        -
          name: zabbix.host.available
          mappings:
            -
              value: '0'
              newvalue: 'not available'
            -
              value: '1'
              newvalue: available
            -
              value: '2'
              newvalue: unknown
  graphs:
    -
      name: 'Active VPN tunnels (IPsec and SSL)'
      graph_items:
        -
          color: 199C0D
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgVpnTunnelUpCount
        -
          sortorder: '1'
          color: 0080FF
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgVpnSslStatsLoginUsers
    -
      name: 'CPU usage'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgSysCpuUsage
    -
      name: 'Hard Disk Usage'
      ymin_type_1: FIXED
      graph_items:
        -
          sortorder: '1'
          drawtype: DASHED_LINE
          color: F63100
          calc_fnc: MAX
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgSysDiskCapacity
        -
          sortorder: '2'
          color: FF8000
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgSysDiskUsage
    -
      name: 'ICMP response time'
      ymin_type_1: FIXED
      graph_items:
        -
          color: 2774A4
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: icmppingsec
    -
      name: 'IPS Metrics'
      ymin_type_1: FIXED
      graph_items:
        -
          color: F63100
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsIntrusionsDetected
        -
          sortorder: '1'
          color: 199C0D
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsIntrusionsBlocked
        -
          sortorder: '2'
          color: F7941D
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsCritSevDetections
        -
          sortorder: '3'
          color: FC6EA3
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsHighSevDetections
        -
          sortorder: '4'
          color: BA2A5D
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsMedSevDetections
        -
          sortorder: '5'
          color: C7A72D
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsLowSevDetections
        -
          sortorder: '6'
          color: 6C59DC
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsInfoSevDetections
        -
          sortorder: '7'
          color: 2774A4
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsAnomalyDetections
        -
          sortorder: '8'
          color: F230E0
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgIpsSignatureDetections
    -
      name: 'IPv4 Concurrent Connections'
      ymin_type_1: FIXED
      graph_items:
        -
          color: 199C0D
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgSysSesCount
    -
      name: 'Memory usage'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          color: 1A7C11
          item:
            host: 'Template Net Fortinet FortiGate SNMP'
            key: fgSysMemUsage
